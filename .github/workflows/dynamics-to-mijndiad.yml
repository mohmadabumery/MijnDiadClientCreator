name: Dynamics â†’ MijnDiAd (Auto-Login + Create Client)

# Trigger whenever temp.json in the pending folder is updated
on:
  push:
    paths:
      - pending/temp.json

jobs:
  login:
    name: Login to MijnDiAd
    runs-on: ubuntu-latest
    outputs:
      session_cookie: ${{ steps.login.outputs.SESSION_COOKIE }}
      xsrf_token: ${{ steps.login.outputs.XSRF_TOKEN }}
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      
      - name: Setup .NET
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: '8.0.x'
      
      - name: Login and Get Session Cookies
        id: login
        run: |
          # Run your login app
          dotnet run --project LoginApp
          
          # Capture environment variables set by LoginApp as workflow outputs
          echo "SESSION_COOKIE=$SESSION_COOKIE" >> $GITHUB_OUTPUT
          echo "XSRF_TOKEN=$XSRF_TOKEN" >> $GITHUB_OUTPUT
        env:
          MIJNDIAD_TENANT: ${{ secrets.MIJNDIAD_TENANT }}
          MIJNDIAD_USERNAME: ${{ secrets.MIJNDIAD_USERNAME }}
          MIJNDIAD_PASSWORD: ${{ secrets.M_
